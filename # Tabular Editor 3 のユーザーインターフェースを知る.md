# Tabular Editor 3 のユーザーインターフェースを知る

2021-09-08
Daniel Otykier

この記事では、Tabular Editor 3のユーザーインターフェースについて説明します。

## 基本的なユーザーインターフェース要素

初めてTabular Editor 3を起動してデータモデルをロードすると、以下のスクリーンショットのようなインターフェースが表示されます。

../../images/basic-ui.png

1. タイトルバーです。ここには、現在読み込まれているファイルの名前や、Analysis Services データベースや Power BI データセットが接続されている場合はその旨が表示されます。
1. メニュー バー。メニューバーからは、Tabular Editor 3 のすべての機能にアクセスできます。すべてのメニュー項目の詳細については、「メニュー」を参照してください。
1. ツールバー。ツールバーからは、よく使う機能に素早くアクセスできます。ツールバーからアクセスできる機能はすべて、メニューからもアクセスできます。ツールバーとそのボタンは、「ツール」→「カスタマイズ」でカスタマイズすることができます。
1. TOMエクスプローラービュー。データモデルを表すTabular Object Model (TOM)のメタデータを階層的に表示します。上部のトグルボタンで、表示するオブジェクトをフィルタリングできます。検索ボックスでは、オブジェクトを名前でフィルタリングすることができます。
1. 式エディタ。エクスプレッションエディタは、TOMエクスプローラで現在選択されているオブジェクトのDAX、SQL、M式を素早く編集することができます。エクスプレッションエディタを閉じても、TOMエクスプローラのオブジェクトをダブルクリックすることで、再び表示させることができます。現在選択されているオブジェクトが複数のプロパティを持っている場合、上部のドロップダウンで異なる式のプロパティを切り替えることができます（例えば、KPIにはターゲット式、ステータス式、トレンド式がありますが、これらは同じKPIオブジェクトに属する3つの異なるDAX式です）。
1. プロパティビュー。TOMエクスプローラで現在選択されているオブジェクトで利用可能なすべてのTOMプロパティの詳細表示です。ほとんどのプロパティは、複数のオブジェクトが選択されている場合でも、グリッドを通して編集することができます。いくつかのプロパティ（"Format String"、"Connection String"、"Role Members "など）は、プロパティ値のセル内にある省略記号ボタンをクリックすると、ポップアップダイアログやコレクションエディタが表示されます。
1. メッセージ表示。Tabular Editor 3は、モデル上のDAX式を継続的に分析し、セマンティックエラーを検出します。そのようなエラーはここに出力されます。また、このビューに表示されるメッセージは、C#スクリプトやAnalysis Servicesから報告されたエラーメッセージに由来するものもあります。
1. ステータス バー。ステータス バーには、現在の選択内容やベスト プラクティス アナライザの調査結果など、さまざまなコンテキスト情報が表示されます。

この他にも、様々な目的に応じたビューが用意されています。詳細は、「表示」メニューのセクションを参照してください。

## ユーザーインターフェースのカスタマイズ

すべてのUI要素は、必要に応じてサイズを変更したり、配置を変えたりすることができます。メインビューから個々のビューをドラッグして、Tabular Editor 3のインスタンスを複数のモニタに分割することもできます。Tabular Editor 3は、アプリケーションを閉じたときにカスタマイズを保存し、次回起動時に自動的に再読み込みします。

### 別のレイアウトの選択

アプリケーションをデフォルトのレイアウトに戻すには、Window > Default layoutオプションを選択します。Tabular Editor 2.xのユーザーは、TOM Explorerを画面の左側に配置し、PropertiesビューをExpression Editorの下に配置するWindow > Classicレイアウトオプションを好むかもしれません。

Window > Capture current layout... "オプションを使用すると、カスタマイズされたレイアウトを保存し、Windowメニュー内の新しいレイアウトオプションとして利用できるようになり、異なるレイアウト間で素早く切り替えることができます。Window > Manage layouts... "オプションを使用すると、利用可能なすべてのレイアウトのリストが表示され、レイアウトの名前変更、保存、削除などが可能になります。レイアウトをディスクに保存すると、結果として.xmlファイルが作成され、Tabular Editor 3の他のユーザと共有することができます。

.../.../images/manage-layouts.png

### テーマとパレットの変更

Tabular Editor 3 の外観は、異なるテーマやパレットを選択することで変更できます。Tabular Editor 3には、5つの異なるテーマ（「スキン」と呼ばれることもあります）が同梱されており、Window > Themesメニューから利用できます。

- Basic and Bezier（ベクターベース、高DPIディスプレイでも動作します）
- Blue, Dark and Light（ラスターベース、高DPIディスプレイにはお勧めできません。）

ベクターベースのテーマ（BasicおよびBezier）では、 Window > Palette メニューを使用して、テーマで使用する色を変更できます。

.../.../images/palettes.png

## Menu

次のセクションでは、Tabular Editor 3のメニューについて詳しく説明します（WIP）。

以下のセクションでは、アクティブドキュメントという用語を使用していますが、これはカーソルが式エディタや下のスクリーンショットの「DAX Script 1」タブなどのドキュメント内に置かれていることを意味しています。キーボードショートカットやメニュー項目の中には、アクティブなドキュメントがあるかどうか、また、アクティブなドキュメントの種類によって動作が異なるものがあります。

.../.../イメージ/アクティブなドキュメント.png

## File

ファイル」メニューには、主にモデルのメタデータやサポートファイル、ドキュメントの読み込みや保存を処理するメニュー項目が含まれています。

.../.../images/file-menu.png

- New サブメニューを開き、新しい空白のデータモデルを作成したり（Ctrl+N）、新しいDAX QueryやDAX Script（テキストファイル）やデータモデル図（JSONファイル）などのさまざまなサポートファイルを作成することができます。サポートファイル（C#スクリプトを除く）は、モデルがすでにTabular Editorに読み込まれている場合にのみ作成できます。

.../.../images/file-menu-new.png

:::note alert
重要事項
Tabular Editor 3 Desktop Editionは、Poewr BI Desktopの外部ツールとしてのみ使用できるため、「New > Model...」オプションは使用できません。詳細はこちらをご覧ください。
<https://docs.tabulareditor.com/te3/editions.html>
:::

- open 様々なソースからデータモデルを読み込むためのオプションや、その他の種類のファイルを読み込むためのオプションを含むサブメニューを開きます。サブメニューの項目は以下の通りです。
  - ファイルからモデル... モデルのメタデータを、.bimや.pbitファイルなどのファイルから開きます。

  - DBからモデルを作成... Analysis Services または Power BI XMLA 接続の詳細を指定するか、Analysis Services のローカル インスタンス (Visual Studio の Integrated Workspace サーバーや Power BI Desktop など) に接続して、既にデプロイされている表形式モデルからモデル メタデータを読み込みます。

  - フォルダからモデル... 任意のバージョンのTabular Editorを使って保存されたフォルダ構造からモデルのメタデータを開きます。

  - ファイル... ファイル名の拡張子に基づいて、Tabular Editor 3でサポートされているあらゆる種類のファイルを開くことができるダイアログが表示されます。詳細については、「サポートされているファイルタイプ」を参照してください。

.../.../images/supported-file-types.png

:::note alert
重要事項
Tabular Editor 3 Desktop Editionでは、Open > Model from file...およびOpen > Model from folder...オプションは使用できません。また、Open > File...ダイアログでは、メタデータを含むファイルではなく、サポートするファイルのみを開くことができます。
:::

- Revert: このオプションでは、モデルのメタデータをソースから再読み込みし、Tabular Editorで行われた変更のうち、まだ保存されていないものを破棄することができます。このオプションは、Tabular Editor 3がPower BI Desktopの外部ツールとして使用されており、Tabular Editor 3が接続されている間にPower BI Desktopで変更が行われた場合に有効です。取り消し」を選択すると、Tabular Editor 3は再接続することなく、Power BI Desktopからモデルのメタデータを再読み込みすることができます。
- Close: アクティブなドキュメント（DAX クエリ、C# スクリプト、データモデル図など）を閉じます。ドキュメントに未保存の変更がある場合、Tabular Editorは閉じる前に変更を保存するように促します。
- Close model: これは、現在読み込まれているモデルのメタデータをTabular Editorからアンロードします。メタデータに変更があった場合は、閉じる前に変更を保存するようにTabular Editorが促します。
- Save: アクティブなドキュメントをソースファイルに保存します。アクティブなドキュメントがない場合は、モデルのメタデータをソースに保存します。ソースとしては、Model.bimファイル、Database.json（フォルダ構造）、Analysis Servicesの接続されたインスタンス（Power BI Desktopを含む）、Power BI XMLAエンドポイントなどが考えられます。
- Save as... アクティブなドキュメントを新しいファイルとして保存することができます。アクティブなドキュメントがない場合は、.bim（JSONベース）ファイルを使用して、モデルのメタデータを新しいファイルとして保存します。
- ave to folder... モデルのメタデータをフォルダ構造で保存することができます。
- Save all: 未保存のドキュメントとモデル・メタデータを一度に保存します。
- Recent files: 最近使用したサポートファイルのリストが表示され、素早くファイルを開くことができます。
- Recent tabular models: 最近使用したモデルメタデータのファイルまたはフォルダーのリストが表示され、これらのファイルからモデルメタデータを素早く再読み込みできます。

:::note alert
重要なこと
Tabular Editor 3 Desktop Editionでは、Save to folder およびRecent tabular models オプションは無効です。また、名前を付けて保存オプションはサポートファイルに対してのみ有効です。
:::

- Exit: Tabular Editor 3アプリケーションをシャットダウンします。アプリケーションをシャットダウンする前に、未保存のファイルやモデルのメタデータを保存するように促されます。

## Edit

Editメニューには、ドキュメントの編集や、現在読み込まれているモデルメタデータの変更を行うための、Windowsアプリケーションの標準的なメニュー項目が含まれています。

.../.../images/edit-menu.png

- Undo:  このオプションは、モデル・メタデータに対して最後に行った変更を元に戻します。アクティブなドキュメントがない場合は、おなじみのCTRL+Zショートカットがこのオプションにマッピングされます。
- Redo: このオプションは、モデルのメタデータに対して最後に行った取り消しを元に戻します。アクティブなドキュメントがない場合は、おなじみのCTRL+Yショートカットがこのオプションに対応します。
- Undo typing: 現在のアクティブなドキュメントで最後に行ったテキスト変更を元に戻します。アクティブなドキュメントがない場合、このオプションは使用できません。
- Redo typing: 現在のアクティブなドキュメント内で最後に行った取り消しを元に戻します。アクティブな文書がない場合は、このオプションは利用できません。
- Find: Find タブを選択した状態で「Find and replace」ダイアログを表示します。[詳細はこちらをご覧ください。](https://docs.tabulareditor.com/te3/views/find-replace.html#find)
- Replace: Replace "タブが選択された "Find and replace "ダイアログを表示します。[詳細はこちらをご覧ください。](https://docs.tabulareditor.com/te3/views/find-replace.html#replace)
- Cut / Copy / Paste: Windows でおなじみの編集操作です。アクティブなドキュメントがある場合は、そのドキュメント内のテキスト選択に適用されます。それ以外の場合は、これらのオプションはTOMエクスプローラ内のオブジェクトを操作するために使用することができます。例えば、SHIFTまたはCTRLキーを押しながらTOM Explorerで小節を選択し、CTRL+C、CTRL+Vの順に押すと、複数の小節を複製することができます。
- Delete:アクティブ・ドキュメントで選択されたテキストを削除します。アクティブ・ドキュメントがない場合は、TOMエクスプローラで現在選択されているオブジェクトを削除します。

:::note
タブラー・エディターでは、複数のオブジェクトが選択されている場合や、削除されるオブジェクトに依存している場合にのみ、オブジェクトの削除を促すメッセージが表示されます。オブジェクトの削除は、元に戻すオプション（CTRL+Z）を使って取り消すことができます。
:::

- Select all: 現在アクティブなドキュメント内の全てのテキスト、またはTOM Exporer内の同じ親に属する全てのオブジェクトを選択します。
- Code assist: このオプションはDAXコードの編集時に利用できます。DAXコードの編集に関連する様々なコードアシスト機能へのショートカットを提供します。詳細については、DAXエディタを参照してください。

## View

ビューメニューでは、Tabular Editor 3 UIのさまざまなビューの間を移動することができます。ビューが非表示になっている場合、このメニューでビューのタイトルをクリックすると、ビューの非表示が解除され、フォーカスされます。なお、ビューメニューにはドキュメントは表示されません。ドキュメント間を移動するには、ウィンドウメニューを使用します。

.../.../images/view-menu.png

TOMエクスプローラ TOM Explorerは、現在読み込まれているモデルのメタデータのTabular Object Model (TOM)全体を階層的に表示します。詳細は「TOMエクスプローラビュー」を参照してください。
ベストプラクティス・アナライザー ベストプラクティス・アナライザーは、ベスト・プラクティス検証のルールを指定することで、モデルの品質向上を支援します。詳細は「ベストプラクティス・アナライザー」ビューを参照してください。
メッセージ。メッセージ] ビューには、Tabular Editor 3 Semantic Analyzer などのさまざまなソースからのエラー、警告、および情報メッセージが表示されます。詳細は「メッセージ」ビューを参照してください。
データ・リフレッシュ。データ・リフレッシュ・ビューでは、バックグラウンドで実行されているデータ・リフレッシュ操作を追跡することができます。詳細は、「データ・リフレッシュ」ビューを参照してください。
マクロ。Macros］ビューでは、作成したマクロを管理できます。マクロはC#スクリプトから作成できます。詳細は、「（チュートリアル）マクロの作成」を参照してください。
VertiPaq Analyzer。VertiPaq Analyzer ビューでは、モデル内のデータに関する詳細な統計情報の収集、インポート、エクスポートを行い、DAX パフォーマンスの向上とデバッグに役立てることができます。VertiPaq Analyzerは、SQLBIのMarco Russo氏がMITライセンスに基づいて作成・管理しています。詳細はGitHubのプロジェクトページをご覧ください。
エクスプレッションエディタ。これは、TOMエクスプローラで現在選択されているオブジェクトのDAX、M、またはSQL式を編集することができる「クイックエディタ」です。詳細はDAXエディタを参照してください。
モデル
モデルメニューは、モデルオブジェクト（TOMエクスプローラのルートオブジェクト）のレベルで実行できるアクションを表示します。

../../images/model-menu.png

デプロイメント..: Tabular Editor Deployment ウィザードを起動します。詳細については、「モデルのデプロイ」を参照してください。
重要事項
Deploy オプションは Tabular Editor 3 Desktop Edition では使用できません。詳細は エディションの比較 をご覧ください。

テーブルのインポート... Tabular Editor 3 の Import Table Wizard を起動します。詳細は、（チュートリアル）テーブルのインポートを参照してください。
テーブルスキーマの更新... 現在選択されているテーブルまたはパーティションのデータソースのスキーマ変更を、現在インポートされている列と比較して検出します。詳細は、「（チュートリアル）テーブルのインポート」を参照してください。
Script DAX: 現在選択されているオブジェクト（何も選択されていない場合は、モデル内のすべてのDAXオブジェクト）のDAXスクリプトを生成します。詳細は、「DAX スクリプト」を参照してください。
モデルを更新します。Tabular EditorがAnalysis Servicesのインスタンスに接続されている場合、このサブメニューにはモデルレベルでバックグラウンドの更新操作を開始するためのオプションが含まれます。このサブメニューには以下のオプションがあります。詳細はリフレッシュコマンド（TMSL）を参照してください。
自動（モデル）。Analysis Servicesがリフレッシュするオブジェクトを決定します（"Ready "状態ではないオブジェクトのみ）。
フルリフレッシュ（モデル）。Analysis Servicesがモデルのフルリフレッシュを実行します。
計算（モデル）。Analysis Services は、すべての計算テーブル、計算列、計算グループ、リレーションシップの再計算を実行します。データソースからのデータの読み込みはありません。
オブジェクトタイプ］を作成します。モデル］メニューの残りのショートカットでは、新しいタイプのモデル子オブジェクト（テーブル、データソース、パースペクティブなど）を作成できます。
ツール
ツールメニューには、Tabular Editor 3の環境設定やカスタマイズを制御するためのオプションがあります。

.../.../images/tools-menu.png

カスタマイズ... Tabular Editor 3 User Interface Layoutのカスタマイズダイアログを起動します。このダイアログでは、新しいツールバーの作成、メニューやツールバーボタンの再配置や編集などを行うことができます。
環境設定... タブラー・エディター3の環境設定ダイアログを起動します。このダイアログは、更新チェック、プロキシ設定、クエリの行数制限、リクエストのタイムアウトなど、タブラー・エディターとその機能の他のすべての側面を管理するための中心となります。詳細は、Controlling preferencesを参照してください。
ウィンドウ
ウィンドウ」メニューには、アプリケーションのさまざまなビューやドキュメント（総称してウィンドウ）を管理したり、それらの間を移動するためのショートカットが用意されています。また、上述のテーマやカラーパレットをコントロールするためのメニュー項目もあります。

.../.../images/window-menu.png

新規...このサブメニューは、新しいサポートファイルを作成するためのショートカットを提供します。このサブメニューのオプションは、［ファイル］＞［新規作成］のオプションと同じです。

フロート... 現在のビューやドキュメントをフローティングウィンドウに戻します。

ピンタブ タブを固定します。タブをピン留めすると、ドキュメントのタブの一番左に表示され、タブを右クリックすると、ピン留めされていないタブだけを閉じるショートカットが用意されています。

.../.../images/tab-context-menu.png

新しい水平/垂直タブグループ。このオプションでは、メインのドキュメント領域を複数のセクション（別名「タブグループ」）に分割し、複数のドキュメントを同時に横並びまたは上下に表示することができます。

すべてのドキュメントを閉じる。すべてのドキュメントのタブを閉じます。保存されていない変更がある場合は、保存するかどうかを確認するメッセージが表示されます。

ウィンドウレイアウトをリセットします。メインドキュメント領域に適用したカスタマイズをすべてリセットします。

1...N [ドキュメント]: 開いているドキュメントの最初の 10 個がここに表示され、ドキュメント間を移動することができます。また、CTLR+Tabのショートカットを使って、以下のスクリーンショットのように、開いているドキュメントやビューを素早く切り替えることができます。

.../.../images/ctrl-tab.png

Windows..: 開いているすべてのドキュメントの一覧を表示するダイアログを開き、ドキュメントを切り替えたり、個別に閉じたりすることができます。

.../.../images/windows-manager.png

現在のレイアウトをキャプチャ / レイアウトの管理... / デフォルトレイアウト / クラシックレイアウト。これらのメニュー項目については、この記事の前半で説明しました。

テーマ / デフォルトのパレット。これらのメニュー項目については、この記事で前述しました。

ヘルプ
ヘルプ」メニューには、オンラインリソースなどのショートカットが用意されています。

.../.../images/help-menu.png

はじめに このメニュー項目は、この記事にリンクしています。
Tabular Editor 3 Docs（英語）。このメニュー項目は docs.tabulareditor.com にリンクしています。
コミュニティサポート。このメニュー項目は、公開されているコミュニティサポートサイトへのリンクです。
専用サポート。このメニュー項目では、専用のサポートホットラインに直接メールを送ることができます。
注意
専用サポートはTabular Editor 3 Enterprise Editionをご利用のお客様専用です。それ以外のお客様は、技術的な問題やご質問、その他の製品固有のご質問について、一般のコミュニティ・サポート・サイトにお問い合わせください。

タブラー・エディターについて。使用しているTabular Editorのバージョン、インストール、ライセンスの詳細情報を表示するダイアログを起動します。このダイアログでは、ライセンスキーの変更も可能です。
ダイナミックメニュー（コンテキスト依存）
上記のメニューに加えて、現在どのUI要素がフォーカスされているか、またTOM Explorerで現在どのオブジェクトが選択されているかに応じて、特定のタイミングで他のメニューが表示されることがあります。例えば、Table-オブジェクトを選択した場合、Tableメニューが表示され、TOMエクスプローラでそのオブジェクトを右クリックしたときと同じコンテキスト固有のショートカット項目が表示されます。

異なるタイプのドキュメント（DAXクエリ、ピボットグリッド、ダイアグラムなど）の間で入力フォーカスを切り替えた場合、現在フォーカスされているドキュメントのタイプを表すメニューも表示されます。そのメニューには、現在のドキュメントに関連する項目が表示されます。例えば、現在ダイアグラムにフォーカスが当たっている場合、ダイアグラムメニューが表示され、ダイアグラムにテーブルを追加するための項目などが表示されます。

これらのダイナミックメニューの動作は、「ツール」→「環境設定」→「ユーザーインターフェース」で変更することができます。
