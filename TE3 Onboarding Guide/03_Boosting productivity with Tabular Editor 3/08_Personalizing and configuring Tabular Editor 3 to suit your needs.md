ニーズに合わせてTabular Editor 3をパーソナライズして設定する
2021-09-28
ダニエル・オティキエ
Tabular Editor 3には、幅広い設定オプションが用意されており、特定のニーズや好みのワークフローに合わせてツールを微調整することができます。この記事では、個人のモデル開発者が最もよく調整する設定についてご案内します。

この記事で取り上げる設定のほとんどは、「ツール」→「環境設定」メニューオプションからアクセスできます。この記事では、個々の設定を以下のようなスタイルで表示し、簡単に参照できるようにしています。

設定の名前（デフォルト値）
設定の説明

一般的な機能
環境設定ダイアログの最初のページは、タブラー・エディター＞機能のページです（下のスクリーンショットを参照）。以下に、このページに掲載されている機能と、それらがどのように使われているかを簡単に説明します。

.../images/pref-一般機能.png

パワーBI
これらの設定は、主にPower BI Desktopの外部ツールとしてTabular Editor 3を使用する開発者に役立ちます。

サポートされていないモデリング操作を許可する（無効）
Power BI Desktopの外部ツールにはいくつかの制限があります。デフォルトでは、Tabular Editor 3はユーザーがデータモデルにサポートされていない変更を加えることを防ぎます。サポートされていないにもかかわらず、うまく動作する高度なモデリング機能があるかもしれません（前出のリンク参照）。すべてのTabular Object Modelオブジェクトとプロパティのロックを解除するには、この設定を有効にします。

自動日付/時刻の警告を隠す(無効)
Power BI Desktopの「自動日付/時刻」設定を有効にすると、多くの計算テーブルが自動的に作成されます。残念ながら、これらのテーブルには、Tabular Editor 3の内蔵DAXアナライザによる警告メッセージを引き起こすDAXコードが含まれています。これらの警告を非表示にするには、この設定を有効にします。

DAXの最初の行で改行する（無効）
Power BI Desktopでは、数式バーにDAXコードが表示されるため、DAX式の1行目に改行を挿入するのが一般的です。Tabular EditorとPower BI Desktopの間を頻繁に行き来する場合は、このオプションを有効にして、Tabular Editor 3でDAX式が編集されるたびに自動的に改行が挿入されるようにすることを検討してください。

メタデータの同期
これらの設定は、Analysis Servicesのインスタンス上のデータベースからモデルのメタデータがロードされたときのTabular Editor 3の動作を制御します。他のユーザーがデータベースに変更を加えた場合や、Tabular Editor 3が外部ツールとして使用されているときにPower BI Desktopでモデルに変更を加えた場合など、アプリケーションの外部からデータベースに適用されたメタデータの変更をTabular Editor 3がどのように処理するかを指定します。

ローカルのメタデータが配備されたモデルと同期していない場合に警告する（有効）
これをチェックすると、モデルのメタデータがTabular Editorのインスタンスに読み込まれた後、他のユーザーやプロセスがデータベースに変更を加えた状態で変更を保存しようとしたときに、Tabular Editorが警告メッセージを表示します。

外部モデルの変更を追跡する（有効）
このオプションは、Analysis Servicesのローカルインスタンス（Tabular Editorと同じマシンで実行されているmsmdsrv.exeプロセス）にのみ関係します。チェックすると、Tabular EditorはAnalysis Servicesのトレースを開始し、外部からの変更があった場合に通知します。

ローカルのTabular Object Modelメタデータを自動的に更新する（有効）
上記のようなトレースメカニズムを有効にすると、このオプションにより、外部からの変更が検出されたときにTabular Editorがモデルのメタデータを自動的に更新できるようになります。Power BI Desktopで行った変更がTabular Editorに自動的に同期されるようになるので、Power BI DesktopとTabular Editor 3を頻繁に行き来する場合に便利です。

孤児となったTabular Editorの痕跡のクリーンアップ
通常、Tabular Editor 3は、上記の設定によって開始されたASトレースを自動的に停止して削除するはずです。しかし、アプリケーションが早期にシャットダウンされた場合は、トレースが停止しないことがあります。このボタンをクリックすると、Analysis Servicesの現在のインスタンス上でTabular Editorの任意のインスタンスによって開始されたすべてのASトレースが削除されます。

注意
クリーンアップボタンは、Tabular EditorがAnalysis Servicesのインスタンスに接続されている場合にのみ使用できます。

TOM Explorerの設定
以下の設定は、TOM Explorerのさまざまな側面を制御します。これらの設定は、[Tabular Editor] > [TOM Explorer]で見つけることができます。

../images/tom-explorer-settings.png

フルブランチを表示(無効)
TOM Explorerをフィルタリングする場合、デフォルトではTabular Editor 3はフィルタ文字列にマッチする階層のすべてのアイテムを親も含めて表示します。すべての子アイテムを表示したい場合は、このオプションを有効にしてください(フィルタ文字列にマッチしない場合もあります)。

常に削除の警告を表示する (無効)
Tabular Editor 3がすべてのオブジェクト削除を確認するプロンプトを表示したい場合は、この設定を有効にします。そうしないと、Tabular Editor 3は、マルチオブジェクトの削除、または他のオブジェクトから参照されているオブジェクトの削除についてのみ確認を促します。

注意
Tabular Editor 3のすべての削除操作は、CTRL+Zを押すことで取り消すことができます。

DAXエディタの一般設定
Tabular Editor 3のDAXエディタは高度な設定が可能なため、多くの設定項目に圧倒されがちです。このセクションでは、最も一般的で重要な設定を紹介します。一般的な設定は、「テキストエディタ」→「DAXエディタ」→「一般」にあります。

.../images/dax-editor-general.png

一般設定
行番号」、「コード折りたたみ」、「可視ホワイトスペース」、「インデントガイド」の各設定は、エディタのさまざまな視覚的機能を切り替えるために使用します。以下のスクリーンショットでは、4つのオプションがすべて有効になっています。

../images/visible-whitespace.png

タブを使う（無効）
このオプションを有効にすると、TABボタンを押したときに、タブ文字が挿入されます。それ以外の場合は、インデント幅の設定に応じた数のスペースが挿入されます。

コメントスタイル(スラッシュ)
DAXでは、スラッシュ（//）またはハイフン（--）を使った行コメントをサポートしています。この設定は、Tabular Editor 3がDAXスクリプト機能を使用するなどしてDAXコードを生成する際に、どちらのスタイルのコメントを使用するかを決定します。

DAX設定
これらの設定は、DAXコードアナライザの特定の動作を決定します。ロケールの設定は単なる好みの問題です。その他の設定は、Model.bimファイルを直接ロードした場合など、Tabular Editor 3が使用するAnalysis Servicesのバージョンを判断できない場合にのみ関係します。この場合、Tabular Editorはモデルで指定された互換性レベルに基づいて、モデルがどのバージョンにデプロイされるかを推測しようとしますが、デプロイメント・ターゲットの実際のバージョンによっては、さまざまなDAX言語の違いがあり、Tabular Editorでは判断できません。Tabular Editorが誤った意味論/構文のエラーを報告する場合は、これらの設定を微調整する必要があるかもしれません。

自動フォーマット
テキストエディタ＞DAXエディタ＞自動フォーマットのページでは、DAXコードのフォーマットを制御するためのさまざまな設定を行うことができます。

.../images/auto-formatting-settings.png

入力中にコードを自動フォーマットする（有効）
このオプションは、特定のキーストロークが発生するたびに、特定のフォーマットルールを自動的に適用します。たとえば、括弧が閉じられると、この機能により、括弧内のすべてがこのページの他の設定に従って書式設定されます。

関数コールの自動フォーマット（有効）
このオプションは、括弧が閉じられたときに、関数呼び出しの自動フォーマット（つまり、引数と括弧の間のスペース）を行うかどうかを制御します。

自動インデント (有効)
このオプションは、関数呼び出しの中で改行が挿入されると、関数の引数を自動的にインデントします。

Auto-brace (有効)
このオプションは、開始波括弧または引用符が入力されると、自動的に終了波括弧または引用符を挿入します。

選択範囲の折り返し（有効）
このオプションを有効にすると、開始波括弧が入力されたときに、現在の選択範囲を閉じ波括弧で自動的に折り返します。

書式規則
これらの設定は、DAXコードのホワイトスペースをどのようにフォーマットするかを制御します。

関数の後のスペース（無効）
有効 無効
SUM ( 'Sales'[Amount] )
関数の後の改行 (無効)
関数の呼び出しを複数の行に分割する必要がある場合にのみ適用されます。

有効 無効
SUM
(
    'Sales'[Amount] (売上高)
)
演算子の前の改行（有効）
二項演算を複数行に分けて行う必要がある場合にのみ適用されます。

有効 無効
[インターネット売上高］
    リセラー売上高] + [リセラー売上高
パッドの括弧(有効)
有効 有効 無効
SUM( 売上高[金額] )
長い形式の行数制限 (120)
DAX形式（長い行）オプションを使用する場合、式が複数の行に分割される前に1つの行に保持する最大文字数。

短い形式の行数制限 (60)
Format DAX (short lines) オプションを使用したときに、複数行にまたがって表現が崩れる前に、1行に保持する最大文字数です。

注意
上記のほとんどの設定は、（デフォルトの）組み込み DAX フォーマッタを使用する場合にのみ有効です。

格納文字と引用符
DAXコードのホワイトスペースのフォーマットに加えて、Tabular Editor 3はオブジェクト参照と関数/キーワードのケーシングを修正することができます。

メジャー/列の修飾子を修正（有効）
これをチェックすると、テーブルの接頭辞がメジャー参照から自動的に削除され、列参照に自動的に挿入されます。

キーワードの優先的な表記 (デフォルト = UPPER)
この設定では、ORDER BY、VAR、EVALUATEなどのキーワードに使用するケーシングを変更できます。この設定は、オートコンプリート機能でキーワードを挿入した場合にも適用されます。

優先する関数のケーシング (デフォルト = UPPER)
この設定では、CALCULATE(...)、SUM(...)などの関数に使用するケーシングを変更できます。これは、オートコンプリート機能で関数を挿入した場合にも適用されます。

キーワード/関数のケーシングを修正する（有効）
これをチェックすると、コードが自動フォーマットまたは手動でフォーマットされたときに、キーワードや関数のケーシングが自動的に修正されます。

オブジェクト参照のケーシングを修正（有効）
DAXは大文字と小文字を区別しない言語です。これを有効にすると、テーブル、列、およびメジャーへの参照は、参照されるオブジェクトの物理的な名前と大文字小文字が一致するように自動的に修正されます。この修正は、コードが自動フォーマットまたは手動フォーマットされるたびに行われます。

常にテーブルを引用する（無効）
特定のテーブル名を参照する場合、DAXでは一重引用符を囲む必要はありません。ただし、テーブル名にかかわらず、テーブルの参照を常に引用符で囲むことを希望する場合は、このオプションをチェックすることができます。

拡張カラムに常にプレフィックスを付ける（無効）
拡張列は、テーブル名なしで定義することができます。これをチェックすると、テーブル名が空白であっても、DAXエディタは常にテーブルのプレフィックスを拡張カラムに追加します。その場合、列の参照は「''拡張列''」のようになります。

次のステップ
Tabular Editor 3で生産性を高める