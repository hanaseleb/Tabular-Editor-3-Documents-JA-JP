タブラー・エディター2.xからの移行について
2021-09-30
ダニエル・オティキエ
この記事は、Power BI DatasetやAnalysis ServicesのTabular開発にTabular Editor 2.xを使用した経験がある開発者を対象としています。この記事では、Tabular Editor 3の類似点と重要な機能追加を紹介し、すぐに使いこなせるようにします。

横並びでのインストール
Tabular Editor 3の製品コードはTabular Editor 2.xとは異なります。つまり、両方のツールを問題なく並べてインストールできます。実際には、ツールはそれぞれ別のプログラムフォルダにインストールされ、設定も別のフォルダに保管されます。つまり、Tabular Editor 2.xとTabular Editor 3の間の「アップグレード」や「ダウングレード」という言葉は当てはまりません。Tabular Editor 3は、まったく別の製品と考えたほうがよいでしょう。

機能比較
機能面では、いくつかの例外を除き、Tabular Editor 3は基本的にTabular Editor 2.xのスーパーセットです。以下の表は、2つのツールのすべての主要機能を比較したものです。

タビュラー・エディター2.x タビュラー・エディター3
すべてのTOMオブジェクトとプロパティを編集できます。
バッチ編集と名前の変更 ✔ ✔ ✔
コピー/ペーストとドラッグ/ドロップのサポート
データモデリング操作のアンドゥ/リドゥ
モデルのメタデータをディスクにロード/セーブする ✔ ✔*。
フォルダへの保存 ✔︎*。
daxformatter.com の統合 ✔ ✔ ✔
高度なデータ モデリング (OLS、パースペクティブ、計算グループ、メタデータの変換など) ✔ ✔ *。

オブジェクト間の DAX 依存関係の表示 ✔ ✔ ✔
テーブルのインポート ウィザード ✔ ✔
デプロイメントウィザード ✔︎*。
ベストプラクティスアナライザ ✔ ✔
C# スクリプトと自動化 ✔ ✔ ✔

SSAS/Azure AS/Power BI Premium に接続する ✔ ✔*。
コマンドラインインターフェース ✔ 近日公開予定
高DPI、マルチモニター、テーマ設定をサポートするカスタマイズ可能なプレミアムユーザーインターフェース
IntelliSenseTM のような機能を備えたワールドクラスの DAX エディター ✔.
オフラインでの DAX 構文チェックとカラム/データ型の推論 ✔ ✔ 改良されたテーブル インポート ウィザードとテーブル スキーマ
Power Query をサポートし、テーブル インポート ウィザードとテーブル スキーマの更新チェックが改善されました。
DAX クエリ、テーブルのプレビュー、ピボットグリッド ✔ ✔ 改良されたテーブルインポートウィザードとテーブルスキーマの更新チェック
テーブルのリレーションシップを可視化および編集するためのダイアグラムの作成 ✔.
バックグラウンドでのデータ更新操作の実行 ✔*。
C# マクロ レコーダー ✔
DAX スクリプトを使用して、1 つのドキュメントで複数の DAX 式を編集します。
VertiPaq Analyzerの統合 ✔
*注: 制限事項は、使用している Tabular Editor 3 のエディションによって異なります。

機能の違い
重要な機能の違いを以下にまとめました。

ユーザーインターフェイス
Tabular Editor 3を起動して最初に気づくのは、新しいVisual Studio Shellのようなインターフェイスです。このインターフェースは完全にカスタマイズ可能で、高DPI、マルチモニターをサポートし、テーマの変更も可能です。すべてのインターフェイス要素は別の場所に移動できるので、Tabular Editor 2.xのインターフェイスレイアウトが好きな人は、すぐにウィンドウメニューからクラシックレイアウトを選択してください。

しかし、一般的には、Tabular Editor 2.xに存在するインターフェース要素はTabular Editor 3でも同じ名前なので、新しいインターフェースをナビゲートするのは比較的簡単なはずです。いくつかの重要な違いを以下に示します。

Tabular Editor 2.xのAdvanced Scriptingタブがなくなりました。Tabular Editor 3では、File > Newメニューを使ってC# Scripts*を作成します。一度に作業できるスクリプトは1つに限られません。また、カスタムアクションの名称がマクロに変更されました。
ダイナミックLINQフィルタリングは、現在TOMエクスプローラでは利用できません。代わりに、Dynamic LINQを使用してオブジェクトを検索したい場合は、CTRL+Fを押して検索と置換のダイアログを表示する必要があります。
エクスプレッション・エディターを閉じた場合は、TOMエクスプローラのオブジェクトのアイコンをダブルクリックするか、「表示」→「エクスプレッション・エディター」メニューオプションを選択することで、元に戻すことができます。
Tabular Editor 3のデフォルトのレイアウトを使用する場合、ベストプラクティス・アナライザーはTOMエクスプローラーの隣のタブとして配置されます。ここには、新しいデータ・リフレッシュ・ビュー(バックグラウンド・リフレッシュ操作のキューを表示)とマクロ・ビュー(C#スクリプトから保存されたマクロを管理)もあります。
Tabular Editor 3は、新しいメッセージビューにすべてのDAX構文およびセマンティックエラーを表示します。デフォルトのレイアウトでは、このビューはインターフェースの左下にあります。
さらに、Tabular Editor 3には、VertiPaq Analyzer（DAX Studioでおなじみ）が搭載されています。
最後になりますが、Tabular Editor 3にはドキュメントという概念が導入されています。ドキュメントとは、C#スクリプト、DAXスクリプト、DAXクエリ、ダイアグラム、データプレビュー、ピボットグリッドの総称に過ぎません。
詳しくは、「ユーザーインターフェイス」をご覧ください。

新しいDAXエディタとセマンティック機能
Tabular Editor 3には、独自のDAX解析エンジン（別名「セマンティックアナライザ」）が搭載されており、モデル内のあらゆるDAXコードのセマンティックを理解することができます。このエンジンは、DAXエディタ（コードネーム "Daxscilla"）にも使用されており、シンタックスハイライギング、自動フォーマット、コード補完、コールチップ、リファクタリングなどの機能を実現しています。もちろん、このエディタは高度な設定が可能で、好みのDAXコーディングスタイルに合わせて微調整することができます。

新しいDAXエディタの詳細については、DAXエディタを参照してください。

さらに、セマンティックアナライザは、モデル内のすべてのオブジェクトのDAX構文やセマンティックエラーを継続的に報告します。これは、Analysis Servicesに接続されていなくても機能し、非常に高速です。セマンティック・アナライザーは、Tabular Editor 3がDAX式からデータ型を自動的に推論することも可能にしました。つまり、Tabular Editor 3は、計算されたテーブル式の結果としてどの列になるかを自動的に検出します。これは、計算されたテーブルの列を手動でマッピングしたり、Analysis Servicesが列のメタデータを返してくれるのに頼ったりしなければならなかったTabular Editor 2.xに比べて、大きな進歩です。

Power Queryをサポートしたテーブルのインポートとスキーマの更新
Tabular Editor 3のTabular Editor 2.xに対するもう一つの大きな利点は、構造化されたデータソースとPower Query（M）のパーティションをサポートしていることです。具体的には、「スキーマの更新」機能がこれらのタイプのデータソースやパーティションでも機能するようになり、テーブルのインポートウィザードでは、新しいテーブルをインポートする際に必要なMコードを生成できるようになりました。

スキーマ比較ダイアログ自体にもいくつかの改良が加えられており、例えば、列削除+列挿入の操作を単一の列名変更の操作に簡単にマッピングできるようになりました（逆も同様）。また、浮動小数点データ型と10進数データ型をどのように扱うかを制御するオプションもあります（例えば、データソースが浮動小数点データ型を使用していても、常に10進数データ型としてインポートしたい場合があります）。

詳細については、「（チュートリアル）テーブルのインポート」を参照してください。

ワークスペースモード
このモードでは、モデルのメタデータがディスク（Model.bimまたはDatabase.json）から読み込まれ、選択したAnalysis Servicesインスタンスに直ちにデプロイされます。保存 (CTRL+S) を押すたびに、ワークスペース データベースが同期され、更新されたモデル メタデータがディスクに保存されます。この方法の利点は、Tabular EditorがAnalysis Servicesに接続されているため、以下のような接続機能が有効であると同時に、ディスク上のソースファイルを簡単に更新できることです。Tabular Editor 2.xでは、データベースからモデルを開き、たまに手動でディスクに保存することを覚えておく必要がありました。

このアプローチは、並行開発を可能にし、モデルのメタデータをバージョン管理システムと統合するのに理想的です。

詳しくは、「（ウォークスルー）ワークスペースモード」をご覧ください。

接続された機能
Tabular Editor 3にはいくつかの新しい接続機能があり、Analysis Servicesのクライアントツールとして使用することができます。これらの機能は、Tabular Editor 3がAnalysis Servicesに直接またはワークスペースモード機能を使用して接続されているときに有効になります。

新しい接続機能は以下の通りです。

テーブルデータのプレビュー
ピボットグリッド(PivotGrids)
DAX クエリ
データのリフレッシュ操作
VertiPaqアナライザー
ダイアグラム
Tabular Editor 2.xの機能で要望が多かったのは、テーブル間の関係をよりよく視覚化できることでした。Tabular Editor 3では、モデル図を作成できるようになりました。各ダイアグラムは、ダイアグラムに含まれるテーブルの名前と座標を保持するシンプルなJSONファイルです。その後、Tabular Editor 3はテーブルと関係をレンダリングし、関係を簡単に編集したり、既存の関係に基づいて図に追加のテーブルを追加したりする機能を提供します。

.../images/diagram-menu.png

詳細については、「ダイアグラムの操作」を参照してください。

C#スクリプトとマクロレコーダ
Tabular Editor 2.xの高度なスクリプティング機能は、C#スクリプトとしてTabular Editor 3に引き継がれています。Tabular Editor 3の重要な違いの1つは、1つのスクリプトでの作業に限定されなくなったことです。代わりに、File > New > C# Scriptオプションを使用して、必要な数のC#スクリプトを作成して作業することができます。タブラー・エディター2.xと同様に、これらのスクリプトは再利用可能なアクションとして保存でき、TOMエクスプローラの右クリックコンテキストメニューに直接統合されます。タブラー・エディター3では、これらのアクションをマクロと呼んでおり、マクロを追加できる独自のメニューやツールバーを作成することもできます。

最も重要なことは、タビュラー・エディター3にはマクロレコーダーが搭載されており、ユーザーのインタラクションからC#コードを自動的に生成するのに使用できることです。

注意
本稿執筆時点では、Tabular Editor 3のC#スクリプトエディタにはインテリセンスのような機能は含まれていません。これは後ほどリリースされる予定です。

詳細については、Introduction to C# scripts and macrosを参照してください。

DAXスクリプティング
Tabular Editor 2.xからの移行時に知っておくべき最後の重要な機能はDAX Scriptingです。この機能を使用すると、複数の計算オブジェクトのDAX式と基本プロパティを一度に編集できるドキュメントを作成することができます。計算オブジェクトとは、メジャー、計算列、計算テーブルなどです。

この機能は、複数のオブジェクトにまたがる複雑なビジネスロジックをオーサリングする際に非常に便利です。TOMエクスプローラでオブジェクトを（複数）選択し、右クリックしてスクリプトDAXオプションを選択すると、選択されたすべてのオブジェクトの定義を含む新しいDAXスクリプトが得られます。DAXスクリプトエディタは、もちろんエクスプレッションエディタやDAXクエリエディタと同じDAX機能を持っています。

接続モードまたはワークスペース・モードで作業している場合、DAXスクリプトは、更新されたビジネス・ロジックを迅速に修正およびテストするための非常に強力なツールです。例えば、以下のスクリーンショットに示すように、ピボット・グリッドと組み合わせて使用する場合などです。SHIFT+F5を押すだけで、スクリプト内のDAX式に基づいてデータベースが更新され、その後、ピボット・グリッドが直ちに更新されます。

.../images/dax-scripting-and-pivot.png

詳細については、「DAX スクリプト機能の使用」を参照してください。

次のステップ
Visual Studio からの移行
Git と Save to Folder を使用した並行開発の実現
Tabular Editor 3で生産性を向上させる